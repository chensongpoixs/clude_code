# 13｜CLI/交互 UX（Streaming / Confirmations / 可读性）

目标：让用户“看得懂、控得住、可追溯”，并减少误操作。

## 1. 交互原则
- 默认先给**计划**，再执行
- 工具调用必须可见（可折叠），并显示影响面（哪些文件/命令）
- 危险动作必须确认（写/删/执行/网络/git push）

## 2. CLI 信息架构（建议）

### 2.1 输出区域
- **对话输出**：模型的自然语言解释
- **工具日志**：每次 tool call 的 name/args 摘要/结果
- **变更预览**：diff/文件列表/统计
- **验证结果**：test/lint/build 的摘要 + 失败定位

### 2.2 关键交互点
- `confirm`：展示风险与范围（single/session/workspace）
- `cancel`：停止当前步骤（并提示是否回滚）
- `resume`：断点续跑（加载 plan + 已完成步骤）

## 3. 流式输出（Streaming）
- 逐 token 输出，但在遇到工具调用时：
  - 先“收束”当前解释段落
  - 再展示工具调用卡片（参数摘要）
  - 工具返回后再继续解释

## 4. 错误展示与建议
- 把错误分为：
  - 可自动修复（提示将进行修复）
  - 需要用户协助（给出具体命令/操作）
- 保留 `trace_id` 方便排查

## 5. 可配置项（建议）
- 输出语言/简洁度
- 默认验证策略（lint/test/build）
- 是否允许后台任务
- 是否显示完整工具参数（默认摘要）


