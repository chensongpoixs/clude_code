<svg id="my-svg" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="flowchart" style="max-width: 822.297px; background-color: white;" viewBox="0 0 822.296875 811.1875" role="graphics-document document" aria-roledescription="flowchart-v2"><style>#my-svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}@keyframes edge-animation-frame{from{stroke-dashoffset:0;}}@keyframes dash{to{stroke-dashoffset:0;}}#my-svg .edge-animation-slow{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 50s linear infinite;stroke-linecap:round;}#my-svg .edge-animation-fast{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 20s linear infinite;stroke-linecap:round;}#my-svg .error-icon{fill:#552222;}#my-svg .error-text{fill:#552222;stroke:#552222;}#my-svg .edge-thickness-normal{stroke-width:1px;}#my-svg .edge-thickness-thick{stroke-width:3.5px;}#my-svg .edge-pattern-solid{stroke-dasharray:0;}#my-svg .edge-thickness-invisible{stroke-width:0;fill:none;}#my-svg .edge-pattern-dashed{stroke-dasharray:3;}#my-svg .edge-pattern-dotted{stroke-dasharray:2;}#my-svg .marker{fill:#333333;stroke:#333333;}#my-svg .marker.cross{stroke:#333333;}#my-svg svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#my-svg p{margin:0;}#my-svg .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#my-svg .cluster-label text{fill:#333;}#my-svg .cluster-label span{color:#333;}#my-svg .cluster-label span p{background-color:transparent;}#my-svg .label text,#my-svg span{fill:#333;color:#333;}#my-svg .node rect,#my-svg .node circle,#my-svg .node ellipse,#my-svg .node polygon,#my-svg .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#my-svg .rough-node .label text,#my-svg .node .label text,#my-svg .image-shape .label,#my-svg .icon-shape .label{text-anchor:middle;}#my-svg .node .katex path{fill:#000;stroke:#000;stroke-width:1px;}#my-svg .rough-node .label,#my-svg .node .label,#my-svg .image-shape .label,#my-svg .icon-shape .label{text-align:center;}#my-svg .node.clickable{cursor:pointer;}#my-svg .root .anchor path{fill:#333333!important;stroke-width:0;stroke:#333333;}#my-svg .arrowheadPath{fill:#333333;}#my-svg .edgePath .path{stroke:#333333;stroke-width:2.0px;}#my-svg .flowchart-link{stroke:#333333;fill:none;}#my-svg .edgeLabel{background-color:rgba(232,232,232, 0.8);text-align:center;}#my-svg .edgeLabel p{background-color:rgba(232,232,232, 0.8);}#my-svg .edgeLabel rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#my-svg .labelBkg{background-color:rgba(232, 232, 232, 0.5);}#my-svg .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#my-svg .cluster text{fill:#333;}#my-svg .cluster span{color:#333;}#my-svg div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#my-svg .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#333;}#my-svg rect.text{fill:none;stroke-width:0;}#my-svg .icon-shape,#my-svg .image-shape{background-color:rgba(232,232,232, 0.8);text-align:center;}#my-svg .icon-shape p,#my-svg .image-shape p{background-color:rgba(232,232,232, 0.8);padding:2px;}#my-svg .icon-shape rect,#my-svg .image-shape rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#my-svg .label-icon{display:inline-block;height:1em;overflow:visible;vertical-align:-0.125em;}#my-svg .node .label-icon path{fill:currentColor;stroke:revert;stroke-width:revert;}#my-svg :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style><g><marker id="my-svg_flowchart-v2-pointEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-pointStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="4.5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 5 L 10 10 L 10 0 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-circleEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="11" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-circleStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="-1" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-crossEnd" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="12" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-crossStart" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="-1" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"/></marker><g class="root"><g class="clusters"><g class="cluster" id="Agent_Thread" data-look="classic"><rect style="fill:#fff3e0 !important;stroke:#333 !important;stroke-width:2px !important" x="8" y="346.1875" width="453.765625" height="280"/><g class="cluster-label" transform="translate(146.5390625, 346.1875)"><foreignObject width="176.6875" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>Agent Thread (后台线程)</p></span></div></foreignObject></g></g><g class="cluster" id="UI_Thread" data-look="classic"><rect style="fill:#e1f5fe !important;stroke:#333 !important;stroke-width:2px !important" x="481.765625" y="169.1875" width="332.53125" height="634"/><g class="cluster-label" transform="translate(580.9140625, 169.1875)"><foreignObject width="134.234375" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>UI Thread (主线程)</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path d="M648.031,95.188L648.031,101.354C648.031,107.521,648.031,119.854,648.031,132.188C648.031,144.521,648.031,156.854,648.031,166.521C648.031,176.188,648.031,183.188,648.031,186.688L648.031,190.188" id="L_User_App_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_User_App_0" data-points="W3sieCI6NjQ4LjAzMTI1LCJ5Ijo5NS4xODc1fSx7IngiOjY0OC4wMzEyNSwieSI6MTMyLjE4NzV9LHsieCI6NjQ4LjAzMTI1LCJ5IjoxNjkuMTg3NX0seyJ4Ijo2NDguMDMxMjUsInkiOjE5NC4xODc1fV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M648.031,272.188L648.031,278.354C648.031,284.521,648.031,296.854,648.031,309.188C648.031,321.521,648.031,333.854,606.554,348.241C565.076,362.628,482.121,379.068,440.643,387.288L399.166,395.508" id="L_App_Loop_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_App_Loop_0" data-points="W3sieCI6NjQ4LjAzMTI1LCJ5IjoyNzIuMTg3NX0seyJ4Ijo2NDguMDMxMjUsInkiOjMwOS4xODc1fSx7IngiOjY0OC4wMzEyNSwieSI6MzQ2LjE4NzV9LHsieCI6Mzk1LjI0MjE4NzUsInkiOjM5Ni4yODU0MjkxNjU4NjAyNX1d" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M360.161,449.188L365.706,455.354C371.25,461.521,382.34,473.854,414.745,488.039C447.149,502.223,500.869,518.259,527.729,526.277L554.589,534.294" id="L_Loop_MsgHandler_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_Loop_MsgHandler_0" data-points="W3sieCI6MzYwLjE2MDg3NTgyMjM2ODQ0LCJ5Ijo0NDkuMTg3NX0seyJ4IjozOTMuNDI5Njg3NSwieSI6NDg2LjE4NzV9LHsieCI6NTU4LjQyMTg3NSwieSI6NTM1LjQzODU5Njk5NTkxODh9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M648.031,601.188L648.031,605.354C648.031,609.521,648.031,617.854,648.031,628.188C648.031,638.521,648.031,650.854,648.031,662.521C648.031,674.188,648.031,685.188,648.031,690.688L648.031,696.188" id="L_MsgHandler_Widgets_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_MsgHandler_Widgets_0" data-points="W3sieCI6NjQ4LjAzMTI1LCJ5Ijo2MDEuMTg3NX0seyJ4Ijo2NDguMDMxMjUsInkiOjYyNi4xODc1fSx7IngiOjY0OC4wMzEyNSwieSI6NjYzLjE4NzV9LHsieCI6NjQ4LjAzMTI1LCJ5Ijo3MDAuMTg3NX1d" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M254.945,436.846L233.306,445.07C211.667,453.293,168.388,469.74,146.749,483.464C125.109,497.188,125.109,508.188,125.109,513.688L125.109,519.188" id="L_Loop_Tools_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_Loop_Tools_0" data-points="W3sieCI6MjU0Ljk0NTMxMjUsInkiOjQzNi44NDU5ODg5NDQ0NDg4fSx7IngiOjEyNS4xMDkzNzUsInkiOjQ4Ni4xODc1fSx7IngiOjEyNS4xMDkzNzUsInkiOjUyMy4xODc1fV0=" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M325.094,449.188L325.094,455.354C325.094,461.521,325.094,473.854,325.094,485.521C325.094,497.188,325.094,508.188,325.094,513.688L325.094,519.188" id="L_Loop_LLM_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_Loop_LLM_0" data-points="W3sieCI6MzI1LjA5Mzc1LCJ5Ijo0NDkuMTg3NX0seyJ4IjozMjUuMDkzNzUsInkiOjQ4Ni4xODc1fSx7IngiOjMyNS4wOTM3NSwieSI6NTIzLjE4NzV9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/></g><g class="edgeLabels"><g class="edgeLabel" transform="translate(648.03125, 132.1875)"><g class="label" data-id="L_User_App_0" transform="translate(-18.6015625, -12)"><foreignObject width="37.203125" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>Input</p></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(648.03125, 309.1875)"><g class="label" data-id="L_App_Loop_0" transform="translate(-73.21875, -12)"><foreignObject width="146.4375" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>Queue: UserMessage</p></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(452.08645, 503.69688)"><g class="label" data-id="L_Loop_MsgHandler_0" transform="translate(-48.3359375, -12)"><foreignObject width="96.671875" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>Queue: Event</p></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(648.03125, 663.1875)"><g class="label" data-id="L_MsgHandler_Widgets_0" transform="translate(-25.84375, -12)"><foreignObject width="51.6875" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>Update</p></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_Loop_Tools_0" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_Loop_LLM_0" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default" id="flowchart-App-0" transform="translate(648.03125, 233.1875)"><rect class="basic label-container" style="" x="-71.7265625" y="-39" width="143.453125" height="78"/><g class="label" style="" transform="translate(-41.7265625, -24)"><rect/><foreignObject width="83.453125" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>Textual App<br />(TUI 应用)</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-MsgHandler-1" transform="translate(648.03125, 562.1875)"><rect class="basic label-container" style="" x="-89.609375" y="-39" width="179.21875" height="78"/><g class="label" style="" transform="translate(-59.609375, -24)"><rect/><foreignObject width="119.21875" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>Message Handler<br />(消息处理器)</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-Widgets-2" transform="translate(648.03125, 739.1875)"><rect class="basic label-container" style="" x="-131.265625" y="-39" width="262.53125" height="78"/><g class="label" style="" transform="translate(-101.265625, -24)"><rect/><foreignObject width="202.53125" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;"><span class="nodeLabel"><p>Widgets<br />(Conversation/Status/Input)</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-Loop-3" transform="translate(325.09375, 410.1875)"><rect class="basic label-container" style="" x="-70.1484375" y="-39" width="140.296875" height="78"/><g class="label" style="" transform="translate(-40.1484375, -24)"><rect/><foreignObject width="80.296875" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>Agent Loop<br />(编排循环)</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-Tools-4" transform="translate(125.109375, 562.1875)"><rect class="basic label-container" style="" x="-82.109375" y="-39" width="164.21875" height="78"/><g class="label" style="" transform="translate(-52.109375, -24)"><rect/><foreignObject width="104.21875" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>Tool Execution<br />(工具执行)</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-LLM-5" transform="translate(325.09375, 562.1875)"><rect class="basic label-container" style="" x="-67.875" y="-39" width="135.75" height="78"/><g class="label" style="" transform="translate(-37.875, -24)"><rect/><foreignObject width="75.75" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>LLM Client<br />(模型调用)</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-User-6" transform="translate(648.03125, 51.59375)"><circle class="basic label-container" style="" r="43.59375" cx="0" cy="0"/><g class="label" style="" transform="translate(-36.09375, -12)"><rect/><foreignObject width="72.1875" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>User/用户</p></span></div></foreignObject></g></g></g></g></g></svg>