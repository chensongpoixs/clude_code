<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg width="600" height="320" viewBox="0 0 600 320" xmlns="http://www.w3.org/2000/svg">
  <desc>带动画的 Code Agent 认知循环原理图</desc>
  <!-- 
    原理说明：
    1. Reasoning (逻辑推理): LLM 根据上下文分析任务并决定调用什么工具。
    2. Action (工具执行): 执行具体的读写、搜索或命令操作。
    3. Observation (结果观测): 捕获工具输出、错误日志或测试结果。
    4. Feedback Loop (反馈环): 将观测结果喂回模型，实现自动修复。
  -->
  <style>
    @keyframes pulse {
      0%, 100% { filter: drop-shadow(0 0 2px rgba(0,0,0,0.1)); opacity: 0.8; }
      50% { filter: drop-shadow(0 0 8px rgba(0,0,0,0.3)); opacity: 1; }
    }
    @keyframes dash {
      to { stroke-dashoffset: -20; }
    }
    
    /* 节点呼吸动画 */
    #box-reasoning { animation: pulse 3s infinite 0s; }
    #box-action { animation: pulse 3s infinite 1s; }
    #box-observation { animation: pulse 3s infinite 2s; }
    
    /* 流动虚线动画 */
    .flow { stroke-dasharray: 5; }
    #path-1 { animation: dash 1s linear infinite; }
    #path-2 { animation: dash 1s linear infinite; }
    #path-feedback { animation: dash 2s linear infinite; }
    
    /* 文本样式 */
    .label { font-family: "PingFang SC", "Microsoft YaHei", sans-serif; font-size: 14px; font-weight: bold; }
    .footer-title { font-family: "PingFang SC", "Microsoft YaHei", sans-serif; font-size: 16px; font-weight: bold; fill: #333; }
    .footer-desc { font-family: "PingFang SC", "Microsoft YaHei", sans-serif; font-size: 12px; fill: #666; }
  </style>

  <!-- 白色背景 -->
  <rect width="600" height="320" fill="#ffffff"/>
  
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#333333" />
    </marker>
  </defs>

  <!-- 1. 逻辑推理节点 -->
  <g id="node-reasoning">
    <rect id="box-reasoning" x="50" y="50" width="120" height="60" rx="10" fill="#E1F5FE" stroke="#01579B" stroke-width="2"/>
    <text x="110" y="80" class="label" text-anchor="middle" dominant-baseline="middle" fill="#01579B">逻辑推理</text>
    <text x="110" y="100" font-size="10" text-anchor="middle" fill="#01579B" opacity="0.7">Reasoning</text>
  </g>
  
  <!-- 2. 工具执行节点 -->
  <g id="node-action">
    <rect id="box-action" x="240" y="50" width="120" height="60" rx="10" fill="#E8F5E9" stroke="#1B5E20" stroke-width="2"/>
    <text x="300" y="80" class="label" text-anchor="middle" dominant-baseline="middle" fill="#1B5E20">工具执行</text>
    <text x="300" y="100" font-size="10" text-anchor="middle" fill="#1B5E20" opacity="0.7">Action (Tools)</text>
  </g>
  
  <!-- 3. 结果观测节点 -->
  <g id="node-observation">
    <rect id="box-observation" x="430" y="50" width="120" height="60" rx="10" fill="#FFF3E0" stroke="#E65100" stroke-width="2"/>
    <text x="490" y="80" class="label" text-anchor="middle" dominant-baseline="middle" fill="#E65100">结果观测</text>
    <text x="490" y="100" font-size="10" text-anchor="middle" fill="#E65100" opacity="0.7">Observation</text>
  </g>
  
  <!-- 流程箭头 -->
  <path id="path-1" class="flow" d="M170 80 H230" stroke="#333333" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
  <path id="path-2" class="flow" d="M360 80 H420" stroke="#333333" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
  
  <!-- 反馈环箭头 (关键：自修复路径) -->
  <path id="path-feedback" class="flow" d="M490 110 V180 H110 V120" stroke="#333333" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
  
  <!-- 底部中文说明 -->
  <text x="300" y="240" class="footer-title" text-anchor="middle">Agent 认知循环系统</text>
  <text x="300" y="265" class="footer-desc" text-anchor="middle">基于工具输出、日志与测试结果的“持续自修复”闭环</text>
  <text x="300" y="285" font-size="11" fill="#999" text-anchor="middle">Code Agent = 推理 + 执行 + 观测 + 修正</text>
</svg>
